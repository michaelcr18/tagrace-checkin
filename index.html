<script>
  function getLocation() {
    document.getElementById("status").innerText = "üì° Getting location‚Ä¶";

    navigator.geolocation.getCurrentPosition(
      (pos) => {
        const lat = pos.coords.latitude;
        const lon = pos.coords.longitude;
        const coords = `${lat},${lon}`;
        document.getElementById("status").innerText = `‚úÖ Location: ${coords}`;

        // üî• Send to webhook
        fetch("https://tagrace-webhook.onrender.com/smarttag", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            tagId: "ZA-004",
            location: coords,
            battery: "3.8V",
            status: "active"
          })
        })
        .then((response) => {
          if (response.ok) {
            console.log("‚úÖ POST succeeded");
          } else {
            console.error("‚ùå POST failed:", response.status);
          }
        })
        .catch((error) => {
          console.error("‚ùå POST error:", error);
        });
      },
      (err) => {
        document.getElementById("status").innerText = `‚ö†Ô∏è Error: ${err.message}`;
      },
      {
        enableHighAccuracy: true,
        timeout: 10000,
        maximumAge: 0
      }
    );
  }
</script>

